(function(q,M){typeof exports=="object"&&typeof module<"u"?M(exports):typeof define=="function"&&define.amd?define(["exports"],M):(q=typeof globalThis<"u"?globalThis:q||self,M(q.OIWikiFeedbackSysFrontend={}))})(this,function(q){"use strict";const M='<svg xmlns="http://www.w3.org/2000/svg" class="iconify-icon iconify-inline" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M11 11v2q0 .425.288.713T12 14t.713-.288T13 13v-2h2q.425 0 .713-.288T16 10t-.288-.712T15 9h-2V7q0-.425-.288-.712T12 6t-.712.288T11 7v2H9q-.425 0-.712.288T8 10t.288.713T9 11zm-5 7l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"/></svg>',X='<svg xmlns="http://www.w3.org/2000/svg" class="iconify-icon iconify-inline" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M7 14h10q.425 0 .713-.288T18 13t-.288-.712T17 12H7q-.425 0-.712.288T6 13t.288.713T7 14m0-3h10q.425 0 .713-.288T18 10t-.288-.712T17 9H7q-.425 0-.712.288T6 10t.288.713T7 11m0-3h10q.425 0 .713-.288T18 7t-.288-.712T17 6H7q-.425 0-.712.288T6 7t.288.713T7 8M4 18q-.825 0-1.412-.587T2 16V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v15.575q0 .675-.612.938T20.3 20.3L18 18zm14.85-2L20 17.125V4H4v12zM4 16V4z"/></svg>',Y='<svg xmlns="http://www.w3.org/2000/svg" class="iconify-icon iconify-inline" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M6.4 19L5 17.6l5.6-5.6L5 6.4L6.4 5l5.6 5.6L17.6 5L19 6.4L13.4 12l5.6 5.6l-1.4 1.4l-5.6-5.6z"/></svg>',Z='<svg xmlns="http://www.w3.org/2000/svg" class="iconify-icon iconify-inline" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M5.85 17.1q1.275-.975 2.85-1.537T12 15t3.3.563t2.85 1.537q.875-1.025 1.363-2.325T20 12q0-3.325-2.337-5.663T12 4T6.337 6.338T4 12q0 1.475.488 2.775T5.85 17.1M12 13q-1.475 0-2.488-1.012T8.5 9.5t1.013-2.488T12 6t2.488 1.013T15.5 9.5t-1.012 2.488T12 13m0 9q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22"/></svg>',tt='<svg xmlns="http://www.w3.org/2000/svg" class="iconify-icon iconify-inline" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M17 22q-1.25 0-2.125-.875T14 19q0-.15.075-.7L7.05 14.2q-.4.375-.925.588T5 15q-1.25 0-2.125-.875T2 12t.875-2.125T5 9q.6 0 1.125.213t.925.587l7.025-4.1q-.05-.175-.062-.337T14 5q0-1.25.875-2.125T17 2t2.125.875T20 5t-.875 2.125T17 8q-.6 0-1.125-.213T14.95 7.2l-7.025 4.1q.05.175.063.338T8 12t-.012.363t-.063.337l7.025 4.1q.4-.375.925-.587T17 16q1.25 0 2.125.875T20 19t-.875 2.125T17 22"/></svg>',et='<svg xmlns="http://www.w3.org/2000/svg" class="iconify-icon iconify-inline" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M3 21v-4.25L16.2 3.575q.3-.275.663-.425t.762-.15t.775.15t.65.45L20.425 5q.3.275.438.65T21 6.4q0 .4-.137.763t-.438.662L7.25 21zM17.6 7.8L19 6.4L17.6 5l-1.4 1.4z"/></svg>',nt='<svg xmlns="http://www.w3.org/2000/svg" class="iconify-icon iconify-inline" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M7 21q-.825 0-1.412-.587T5 19V6H4V4h5V3h6v1h5v2h-1v13q0 .825-.587 1.413T17 21zm2-4h2V8H9zm4 0h2V8h-2z"/></svg>',ot=function(t,e){return t.reduce((s,i)=>((s[e(i)]=s[e(i)]||[]).push(i),s),{})},W=new Intl.DateTimeFormat("zh-CN",{dateStyle:"short",timeStyle:"short"});let G=!1,$="/api",l=null,o,P,v,H;const at=async()=>{const t=await fetch(`${$}meta/github-app`,{method:"GET"});if(!t.ok)throw t;H||(H=(await t.json()).data)},it=()=>{const t=new URL(window.location.href),e=t.searchParams.get("oauth_token");e&&(document.cookie=`oauth_token=${e}; path=/; expires=${new Date(JSON.parse(atob(e.split(".")[1])).exp*1e3).toUTCString()}; secure`,t.searchParams.delete("oauth_token"),window.history.replaceState(null,"",t.toString()))},A=()=>document.cookie.replace(/(?:(?:^|.*;\s*)oauth_token\s*\=\s*([^;]*).*$)|^.*$/,"$1"),D=()=>{const t=A();if(!t)return;const e=t.split(".")[1],s=Array.from(atob(e),a=>a.charCodeAt(0)),i=new TextDecoder("utf-8").decode(new Uint8Array(s));return JSON.parse(i)},st=async()=>{var h;const e=new URL(window.location.href).hash;if(!e)return;const s=(h=/#comment-(\d+)/.exec(e))==null?void 0:h[1];if(!s)return;const i=parseInt(s);await L();const a=o==null?void 0:o.find(w=>w.id===i);if(!a)return;const n=[a.offset.start,a.offset.end],p=document.querySelector(`[data-review-enabled][data-original-document-start="${n[0]}"][data-original-document-end="${n[1]}"]`);if(!p)return;await N({el:p,focusReply:!0});const d=document.querySelector(`.comment[data-id="${i}"]`);d==null||d.classList.add("comment_highlighting"),d==null||d.scrollIntoView({behavior:"smooth",block:"center"})},O=()=>{document.cookie="oauth_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT; secure"},F=({idOrClass:t,content:e,actions:s=new Map,parent:i=document.body,insertPosition:a="beforeend",tag:n="div",isClass:p=!1,initialize:d=()=>{}})=>{let h=document.querySelector(`#${t}`);if(!p&&h)return h;i.insertAdjacentHTML(a,`
    <${n} ${p?`class="${t}"`:`id="${t}"`}>
      ${e.trim()}
    </${n}>
    `.trim()),h=i.querySelector(p?`.${t}`:`#${t}`),d(h);const w=h.querySelectorAll("[data-action]");for(const g of w)g.addEventListener("click",R=>{var k;R.stopPropagation();const V=R.currentTarget,b=V.dataset.action??"";(k=s.get(b))==null||k(V)});return h},N=async({el:t,focusReply:e=!1})=>{l!==t&&(l==null||delete l.dataset.reviewSelected,l=t),(l!=null&&l.dataset.reviewHasComments||e)&&(delete l.dataset.reviewFocused,l.dataset.reviewSelected="true",await T())},ct=()=>{l==null||delete l.dataset.reviewSelected,l=null},rt=({el:t})=>{t.querySelector(".review-context-menu")||F({idOrClass:"review-context-menu",content:`
    <button data-action="comment">
      ${M}
    </button>
    `,parent:t,actions:new Map([["comment",()=>{N({el:t,focusReply:!0})}]]),isClass:!0,initialize:e=>{e.addEventListener("mouseenter",()=>{t.dataset.reviewFocused="true"}),e.addEventListener("mouseleave",()=>{delete t.dataset.reviewFocused}),e.style.display="none"}})},dt=({el:t})=>{const e=t.querySelector(".review-context-menu");if(!e){console.error("openContextMenu called but contextMenu not found");return}e.style.display=""},mt=({el:t})=>{const e=t.querySelector('.review-context-menu:not([style*="display: none"])');if(!e){console.error("closeContextMenu called but contextMenu not found");return}e.style.display="none"},T=async()=>{const t=[...await L()],e=l;e&&t.find(a=>a.offset.start===parseInt(e.dataset.originalDocumentStart)&&a.offset.end===parseInt(e.dataset.originalDocumentEnd))===void 0&&t.push({id:-1,offset:{start:parseInt(e.dataset.originalDocumentStart),end:parseInt(e.dataset.originalDocumentEnd)},commenter:{name:"",oauth_provider:"github",oauth_user_id:""},comment:"",created_time:new Date().toISOString(),last_edited_time:null,pending:!0}),ft(t);let s=document.querySelector(`#review-comments-panel .comments_group[data-original-document-start="${l==null?void 0:l.dataset.originalDocumentStart}"][data-original-document-end="${l==null?void 0:l.dataset.originalDocumentEnd}"]`);s&&(s.dataset.reviewSelected="true"),s==null||s.scrollIntoView({behavior:"smooth",block:"start"});const i=s==null?void 0:s.querySelector(".comment_actions_panel textarea");i==null||i.focus(),P.classList.add("review_hidden"),v.classList.remove("review_hidden")},J=()=>{v.classList.add("review_hidden"),P.classList.remove("review_hidden")},lt=async({offsets:t,content:e})=>{var d,h,w;const s=sessionStorage.getItem("commitHash");if(!s)throw new Error("找不到 Commit hash，请联系站点管理员");const i={offset:{start:t[0],end:t[1]},comment:e},a=fetch(`${$}comment/${encodeURIComponent(new URL(window.location.href).pathname)}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${A()}`},body:JSON.stringify({...i,commit_hash:s})}),n=(o==null?void 0:o.length)??-1;o&&o.push({...i,commenter:{name:((d=D())==null?void 0:d.name)??"未知用户",oauth_provider:(h=D())==null?void 0:h.provider,oauth_user_id:((w=D())==null?void 0:w.id)??"-1"},id:o.length,created_time:new Date().toISOString(),last_edited_time:null,pending:!0});const p=await a;if(!p.ok)throw o&&(o=o.filter(g=>g.id!==n)),p;o&&(o=o.map(g=>g.id===n?{...g,pending:!1}:g)),await L(!0),z()},ut=async({id:t,comment:e})=>{const s=fetch(`${$}comment/${encodeURIComponent(new URL(window.location.href).pathname)}/id/${t}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${A()}`},body:JSON.stringify({comment:e})});o&&(o=o.map(a=>a.id===t?{...a,pending:!0}:a));const i=await s;if(!i.ok)throw o&&(o=o.map(a=>a.id===t?{...a,pending:!1}:a)),i;o&&(o=o.map(a=>a.id===t?{...a,comment:e,pending:!1}:a)),await L(!0),z()},_t=async({id:t})=>{const e=fetch(`${$}comment/${encodeURIComponent(new URL(window.location.href).pathname)}/id/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${A()}`}});o&&(o=o.map(i=>i.id===t?{...i,pending:!0}:i));const s=await e;if(!s.ok)throw o&&(o=o.map(i=>i.id===t?{...i,pending:!1}:i)),s;o&&(o=o.filter(i=>i.id!==t)),await L(!0),z()},L=async(t=!1)=>{if(!t&&o)return o;const e=await fetch(`${$}comment/${encodeURIComponent(new URL(window.location.href).pathname)}`);if(!e.ok)throw e;const s=(await e.json()).data;return o=s,s},ft=t=>{const e=v.querySelector(".panel_main"),s=document.createDocumentFragment(),i=ot(t,a=>`${a.offset.start}-${a.offset.end}`);for(const a of Object.keys(i).sort((n,p)=>parseInt(n.split("-")[0])-parseInt(p.split("-")[0]))){const n=document.createElement("div");n.classList.add("comments_group");const p=a.split("-");n.dataset.originalDocumentStart=p[0],n.dataset.originalDocumentEnd=p[1];const d=document.querySelector(`[data-review-enabled][data-original-document-start="${n.dataset.originalDocumentStart}"][data-original-document-end="${n.dataset.originalDocumentEnd}"]`),h=(d==null?void 0:d.textContent)??"";n.innerHTML=`
      <div class="comments_group_header">
        <span class="comments_group_text_content">${h}</span>
      </div>
      <div class="comments_group_main"></div>
      <div class="comments_group_footer">
        <div class="comment_actions_panel">
          <div class="comment_actions_header">
            <span class="comment_username"></span>
            <button class="comment_actions_item" data-action="logout">退出登录</button>
          </div>
          <textarea required placeholder="写下你的评论..."  autocapitalize="sentences" autocomplete="on" spellcheck="true" maxlength="65535"></textarea>
          <div class="comment_actions_footer">
            <span class="comment_actions_notification"></span>
            <div class="comment_actions comment_actions_login">
              <button class="comment_actions_item comment_actions_item_btn comment_actions_item_btn_primary" data-action="login">登录到 GitHub</button>
            </div>
            <div class="comment_actions comment_actions_modify">
              <button class="comment_actions_item comment_actions_item_btn" data-action="modify_cancel">取消</button>
              <button class="comment_actions_item comment_actions_item_btn comment_actions_item_btn_primary" data-action="modify_submit">修改</button>
            </div>
            <div class="comment_actions comment_actions_reply">
              <button class="comment_actions_item comment_actions_item_btn" data-action="cancel">取消</button>
              <button class="comment_actions_item comment_actions_item_btn comment_actions_item_btn_primary" data-action="submit">提交</button>
            </div>
          </div>
        </div>
      </div>
    `.trim();const w=r=>{r.style.height="5px",r.style.height=r.scrollHeight+"px"};n.querySelector(".comment_actions_panel textarea").addEventListener("input",r=>{const c=r.currentTarget;w(c)});const g=n.querySelector(".comment_username"),R=n.querySelector(".comment_actions_login"),V=n.querySelector("button.comment_actions_item[data-action='logout']"),b=D();b?(g.textContent=`作为 ${b.name} 发表评论`,R.style.display="none"):(g.textContent="登录到 GitHub 以发表评论",V.style.display="none");const k=n.querySelector(".comment_actions_modify");k.style.display="none",n.addEventListener("mouseenter",()=>{d&&(d.dataset.reviewFocused="true")}),n.addEventListener("mouseleave",()=>{d==null||delete d.dataset.reviewFocused}),n.addEventListener("click",r=>{var c;r.stopPropagation(),l==null||delete l.dataset.reviewSelected,d==null||delete d.dataset.reviewFocused,d==null||delete d.dataset.reviewSelected,(c=document.querySelector(".comments_group[data-review-selected]"))==null||delete c.dataset.reviewSelected,n.dataset.reviewSelected="true",l=d,l==null||l.scrollIntoView({behavior:"smooth",block:"center"})});const ht=i[a].sort((r,c)=>new Date(r.created_time).getTime()-new Date(c.created_time).getTime()),yt=n.querySelector(".comments_group_main");for(const r of ht){if(r.id===-1)continue;const c=document.createElement("div");c.classList.add("comment"),r.pending&&c.classList.add("comment_pending"),c.dataset.id=r.id.toString(),c.innerHTML=`
        <div class="comment_container">
          <div class="comment_side">
            <div class="comment_user_avatar">
              <img src="${r.commenter.avatar_url}" alt="user avatar"/>
            </div>
          </div>
          <div class="comment_base">
            <div class="comment_header">
              <a class="comment_commenter"></a>
              <span class="comment_time comment_created_time">发布于 ${W.format(new Date(r.created_time))}</span>
              <span class="comment_time comment_edited_time">最后编辑于 ${r.last_edited_time?W.format(new Date(r.last_edited_time)):""}</span>
              <div class="comment_actions">
                <button class="comment_actions_item" data-action="copy_permalink" title="分享">${tt}</button>
                <button class="comment_actions_item comment_actions_item_administration" data-action="modify" title="编辑">${et}</button>
                <button class="comment_actions_item comment_actions_item_administration" data-action="delete" title="删除">${nt}</button>
              </div>
            </div>
            <div class="comment_main">
              <span class="comment_content"></span>
              <span class="comment_edit_tag">(已编辑)</span>
            </div>
          </div>
        </div>
        <div class="comment_tailing">
          <button class="comment_actions_item comment_expand" data-action="expand">展开</button>
          <button class="comment_actions_item comment_expand" data-action="fold">折叠</button>
        </div>
      `.trim();const u=c.querySelector(".comment_commenter");r.commenter.name&&(u.textContent=r.commenter.name,u.title=r.commenter.name);const _=c.querySelector(".comment_user_avatar");r.commenter.profile_url&&(u.target="_blank",u.href=r.commenter.profile_url,_.style.cursor="pointer",_.addEventListener("click",()=>{window.open(r.commenter.profile_url)})),r.commenter.avatar_url||(_.innerHTML=Z),c.querySelector(".comment_main .comment_content").textContent=r.comment;const E=c.querySelector(".comment_header .comment_actions");let S=!0,B=!0;(!b||b.provider!==r.commenter.oauth_provider||b.id!==r.commenter.oauth_user_id)&&(S=!1),b&&b.isAdmin===!0&&(S=!0),r.id===-1&&(S=!1),S||E.querySelectorAll(".comment_actions_item_administration").forEach(j=>{j.style.display="none"}),!S&&!B&&(E.style.display="none");const I=c.querySelector(".comment_header .comment_created_time"),x=c.querySelector(".comment_header .comment_edited_time");x.style.display="none",r.last_edited_time&&I.addEventListener("click",()=>{I.style.display="none",x.style.display=""}),x.addEventListener("click",()=>{I.style.display="",x.style.display="none"});const U=c.querySelector(".comment_main .comment_edit_tag");r.last_edited_time||(U.style.display="none"),yt.appendChild(c)}for(const r of n.querySelectorAll(".comment_actions_item"))r.addEventListener("click",()=>{var S,B,I,x,U,j;const c=r,u=n.querySelector(".comment_actions_panel textarea"),_=n.querySelector(".comment_actions_notification"),E=async m=>{var f;if(console.error(m),m instanceof Error)_.textContent=m.message;else if(m instanceof Response){if(m.status===401){_.textContent="身份验证失效，请重新登录",O();return}if(((f=m.headers.get("content-type"))==null?void 0:f.includes("application/json"))===!0){const y=await m.json();_.textContent=y.error}else _.textContent=`未知接口错误：${m.status}(${m.statusText})`}else _.textContent="提交失败，请稍后再试"};switch(c==null?void 0:c.dataset.action){case"copy_permalink":{c.dataset.tag="using";const m=n.querySelector(`.comment:has([data-tag="using"][data-action="${c==null?void 0:c.dataset.action}"])`);delete c.dataset.tag;const f=(S=m==null?void 0:m.dataset)==null?void 0:S.id;if(f==null)return;const y=new URL(window.location.href);y.hash=`#comment-${f}`,navigator.clipboard.writeText(y.toString()).then(()=>{_.textContent="已复制评论链接地址"});break}case"login":{if(!H){console.log("githubMeta not ready");return}window.location.href=`https://github.com/login/oauth/authorize?client_id=${H.client_id}&state=${encodeURIComponent(JSON.stringify({redirect:window.location.href}))}`;break}case"logout":{O(),window.location.reload();break}case"cancel":{u.disabled=!1,u.value="",_.textContent="",w(u);break}case"submit":{if(u.disabled=!0,!u.checkValidity()){_.textContent="请填写评论内容",u.disabled=!1;return}_.textContent="",lt({offsets:[parseInt(l.dataset.originalDocumentStart),parseInt(l.dataset.originalDocumentEnd)],content:u.value}).then(()=>{u.value="",_.textContent=""}).catch(E).finally(()=>{T().then(()=>{const m=v.querySelector("[data-review-selected] .comment_actions_notification"),f=v.querySelector("[data-review-selected] .comment_actions_panel textarea");m&&(m.textContent=_.textContent),f&&(f.value=u.value)})}),T().then(()=>{const m=v.querySelector("[data-review-selected] button[data-action='submit']");m&&(m.disabled=!0)});break}case"modify":{(B=n.querySelector(`.comment[data-id="${n.dataset.modifingId}"]`))==null||B.classList.remove("comment_pending"),c.dataset.tag="using";const m=n.querySelector(`.comment:has([data-tag="using"][data-action="${c==null?void 0:c.dataset.action}"])`);delete c.dataset.tag;const f=(I=m==null?void 0:m.dataset)==null?void 0:I.id;if(f==null)return;m==null||m.classList.add("comment_pending"),k.style.display="",n.dataset.modifingId=f,u.value=((x=o==null?void 0:o.find(C=>C.id===parseInt(f)))==null?void 0:x.comment)??"";const y=n.querySelector(".comments_group_footer");y.style.display="block",w(u),y.style.display="";break}case"modify_cancel":{(U=n.querySelector(`.comment[data-id="${n.dataset.modifingId}"]`))==null||U.classList.remove("comment_pending"),k.style.display="none",delete n.dataset.modifingId,u.disabled=!1,u.value="",_.textContent="",w(u);break}case"modify_submit":{const m=n.dataset.modifingId;if(m==null)return;ut({id:parseInt(m),comment:u.value}).then(()=>{u.value="",_.textContent=""}).catch(E).finally(()=>{T().then(()=>{const f=v.querySelector("[data-review-selected] .comment_actions_notification"),y=v.querySelector("[data-review-selected] .comment_actions_panel textarea");f&&(f.textContent=_.textContent),y&&(y.value=u.value)})}),T();break}case"delete":{c.dataset.tag="using";const m=n.querySelector(`.comment:has([data-tag="using"][data-action="${c==null?void 0:c.dataset.action}"])`);delete c.dataset.tag;const f=(j=m.dataset)==null?void 0:j.id;if(f==null)return;_t({id:parseInt(f)}).catch(E).finally(()=>{T().then(()=>{const y=v.querySelector("[data-review-selected] .comment_actions_notification"),C=v.querySelector("[data-review-selected] .comment_actions_panel textarea");y&&(y.textContent=_.textContent),C&&(C.value=u.value)})}),T().then(()=>{const y=v.querySelector("[data-review-selected] .comment_actions_notification"),C=v.querySelector(`.comment[data-id="${f}"] button[data-action="delete"]`),Q=v.querySelector(`.comment[data-id="${f}"] button[data-action="modify"]`);y&&(y.textContent=_.textContent),C&&(C.disabled=!0),Q&&(Q.disabled=!0)});break}}});s.appendChild(n)}for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(s);for(const a of v.querySelectorAll(".comment")){const n=a.querySelector(".comment_main"),p=a.querySelector('.comment_tailing .comment_expand[data-action="expand"]'),d=a.querySelector('.comment_tailing .comment_expand[data-action="fold"]'),h=n.offsetHeight;n.scrollHeight<=h&&(p.style.display="none"),d.style.display="none",p.addEventListener("click",()=>{p.style.display="none",d.style.display="",n.style.maxHeight="100%",n.style.maxHeight=n.scrollHeight+"px"}),d.addEventListener("click",()=>{p.style.display="",d.style.display="none",n.style.maxHeight=`${h}px`})}},z=async()=>{const t=Array.from(document.querySelectorAll("[data-review-enabled][data-original-document-start][data-original-document-end]"));await L();for(let e of t)delete e.dataset.reviewHasComments,o.find(s=>s.offset.start===parseInt(e.dataset.originalDocumentStart)&&s.offset.end===parseInt(e.dataset.originalDocumentEnd))&&(e.dataset.reviewHasComments="true")},K="0.5.6";function pt(t,{apiEndpoint:e="/api"}={}){$=e.endsWith("/")?e:e+"/",it();const s=Array.from(t.querySelectorAll("[data-original-document-start][data-original-document-end]"));if(!s){console.warn("oiwiki-feedback-sys-frontend not found any offsets to inject, quitting...");return}for(let i of s)i.dataset.reviewEnabled="true",i.addEventListener("click",a=>{a.stopPropagation(),N({el:a.currentTarget})}),i.addEventListener("mouseenter",a=>{dt({el:a.currentTarget})}),i.addEventListener("mouseleave",a=>{mt({el:a.currentTarget})}),rt({el:i});if(o=void 0,z(),at(),G){J(),console.log("oiwiki-feedback-sys-frontend has been successfully reset.");return}document.addEventListener("click",()=>{ct()}),P=F({idOrClass:"review-comments-button",content:`
    <button data-action="open">
      ${X}
    </button>
    `,actions:new Map([["open",()=>T()]])}),v=F({idOrClass:"review-comments-panel",content:`
    <div class="panel_header">
      <span>本页评论</span>
      <button data-action="close">
        ${Y}
      </button>
    </div>
    <div class="panel_main"></div>
    `,actions:new Map([["close",()=>J()]])}),J(),st(),console.log(`oiwiki-feedback-sys-frontend version ${K} has been successfully installed.`),G=!0}q.__VERSION__=K,q.setupReview=pt,Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})});
